;name:        attiny85_all_leds_off.S
;description: turn on all the LED connected to PINB0 .. PINB4 and back of after 5 secs.
;             don't try this with PINB5, this pin cannot be used because it is setup as RESET pin,
;             PINB6 and PINB7 are reserved pins by the manufacturer.
;build:       make flash

#define    DDRB  0x17
#define    PORTB 0x18
#define    PINB  0x16
;as information
#define    PINB0 0x00
#define    PINB1 0x01
#define    PINB2 0x02
#define    PINB3 0x03
#define    PINB4 0x04

.section .text
.global main

main:

    ldi     r16, 0x1F           ;pins 0..4 HIGH, pins 5, 6 and 7 are reserved
    out     DDRB, r16
    out     PORTB, r16          ;write to PORTB

    ;delay of 5 secs
    ;Assembly code auto-generated by utility from Bret Mulvey
    ;Delay 5 000 000 cycles 5s at 1.0 MHz
    ;http://darcy.rsgc.on.ca/ACES/TEI4M/AVRdelay.html

    ldi     r18, 26
    ldi     r19, 94
    ldi     r20, 111
l1: dec     r20
    brne    l1
    dec     r19
    brne    l1
    dec     r18
    brne    l1
    nop
    
;all leds back off
    ldi     r16,0
    out     PORTB, r16          ;write to PORTB
    
loop:
    rjmp    loop                ;repeat

.end
