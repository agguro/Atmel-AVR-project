;name:        attiny85_single_led_off.S
;description: turn on the LED connected to PINB4, wait a while and put it back off
;             don't try this with PINB5, this pin cannot be used because it is setup as RESET pin,
;             PINB6 and PINB7 are reserved pins by the manufacturer.
;build:       make flash

#define    DDRB  0x17
#define    PORTB 0x18
#define    PINB  0x16
#define    PINB4 0x04

.section .text
.global main

main:
    ldi     r16, 0x1F           ;pins 0 .. 4 as output
    out     DDRB, r16           ;set pins in DDRB
    ldi     r16, 0x00           ;all pins low
    out     PORTB, r16
    sbi     PORTB, PINB4        ;set PINB4 of PORTB to HIGH

;delay of 5 secs
;Assembly code auto-generated by utility from Bret Mulvey
;Delay 5 000 000 cycles 5s at 1.0 MHz
;http://darcy.rsgc.on.ca/ACES/TEI4M/AVRdelay.html

    ldi     r18, 26
    ldi     r19, 94
    ldi     r20, 111
l1: dec     r20
    brne    l1
    dec     r19
    brne    l1
    dec     r18
    brne    l1
    nop

;set PINB4 back to LOW, led off    
    cbi     PORTB, PINB4        ;set PINB4 of PORTB to LOW
    
loop:    
    rjmp     loop

.end
