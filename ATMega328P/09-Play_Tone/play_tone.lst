
AVRA   Ver. 1.3.0 play_tone.asm Fri Dec 10 16:49:54 2021


         ;name:          5161AS-single-digit-led.asm
         ;assemble:      avra 5161AS-single-digit-led.asm
         ;flash:         avrdude -c arduino -p m328p -P /dev/ttyACM0 -b 115200 -U flash:w:5161AS-single-digit-led.hex
         ;description:   small demonstration on how to deal with the 5161AS single digit led.
         ;               the program lits one led at a time with a 05. sec delay between the next state.
         ;               the only registers used is r16 and the carry flag.
         ;               assumed is that the led segments are connected to PORTD with the next configuration:
         ;               led - gate - value in r16
         ;                A     0       00000001
         ;                B     1       00000010
         ;                C     2       00000100
         ;                D     3       00001000
         ;                E     4       00010000
         ;                F     5       00100000
         ;                G     6       01000000
         ;               DP     7       10000000
         ;remark:        not using the delay functions gives the impression that all leds lits as one.
         ;dec 9, 2021 - agguro - no-license license
         
          .device ATmega328P
         
          .equ    PORTB   = 0x05
          .equ    DDRB    = 0x04
         
          .cseg
          .org 0x00
         
         
         
          start:
C:000000 e001          ldi     r16,0b00000001  ;r16 = 0xFF all ports as output
C:000001 b904          out     DDRB,r16        ;r16 to DDRD (0x0a) controls PORTD's in/out state.
C:000002 b905          out     PORTB,r16       ;write r16 to PORTD
             
C:000003 940e 0008     call    delay           ;wait a while
C:000005 e000          ldi     r16,0b00000000  ;r16 = 0xFF all ports as output
C:000006 b905          out     PORTB,r16       ;write r16 to PORTD
             
          loop:    
C:000007 cfff          rjmp    loop            ;continu rotating and writing
             
         ;Assembly code auto-generated by utility from Bret Mulvey
         ;Delay 7 999 996 cycles - 499ms 999us 750 ns at 16.0 MHz
         ;http://darcy.rsgc.on.ca/ACES/TEI4M/AVRdelay.html
          delay:
C:000008 e125          ldi     r18, 21
C:000009 e43b          ldi     r19, 75
C:00000a e440          ldi     r20, 64
          l1: 
C:00000b 954a          dec     r20
C:00000c f7f1          brne    l1
C:00000d 953a          dec     r19
C:00000e f7e1          brne    l1
C:00000f 952a          dec     r18
C:000010 f7d1          brne    l1
C:000011 9508          ret


Segment usage:
   Code      :        18 words (36 bytes)
   Data      :         0 bytes
   EEPROM    :         0 bytes

Assembly completed with no errors.
